<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />

    <meta name="description" content="">
    <meta name="author" content="Morgan Rehnberg">

    <title>9/11 Kiosk</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">

    <style>

      @font-face {
        font-family: Gotham-Bold;
        src: url(Gotham-Bold.otf);
      }
      @font-face {
        font-family: Gotham-Book;
        src: url(Gotham-Book.otf);
      }
      @font-face {
        font-family: Gotham-Medium;
        src: url(Gotham-Medium.otf);
      }
      @font-face {
        font-family: Gotham-Light;
        src: url(Gotham-Light.otf);
      }

      body, html {
        margin: 0px;
        padding: 0px;
        background: #456990;
        /* cursor: none; */
      }
      ::-webkit-scrollbar {
        width: 0;
      }
      .hero-image {
        position: absolute;
        width: 100%;
        opacity: 0;
      }
      .icon {
        width: 17vw;
        align-items: flex-end;
        display: flex;
        border-style: solid;
        border-color: #456990;
        border-width: 20px;
      }
      #content-pane {
        position: absolute;
        width: 80vw;
        height: 25vh;
        top: 45vh;
        left: 10vw;
        background-color: rgba(0,0,0, 0.6);
      }
      #description-text {
        height: 17vh;
        overflow: scroll;
        font-size: 40px;
      }
      #fadeOutZone {
        opacity: 0;
      }
      #header {
        height: 10vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #header-text {
        font-size: 130px;
        font-family: Gotham-Bold;
      }
      #icon-attack {
      }
      #icon-legacy {
      }
      #icon-prologue {
      }
      #icon-response {
      }
      #icon-row {
        position: absolute;
        top: 67vh;
        height: 25vh;
        width: 100vw;
      }
      #icon-military {
      }
      #langToggleButton {
        font-size: 60px;
      }
      #learn-more {
        font-size: 40px;
        font-family: Gotham-Medium;
      }
      #toolbar {
        height: 5vh;
        font-family: Gotham-Medium;
      }
      #top-panel {
        width: 100vw;
        height: 70vh;
        font-family: Gotham-Book;
      }
    </style>
  </head>

  <body>
    <main id='mainContainer' role="main" class="container-fluid px-0">

      <header id='header' class='bg-secondary sticky-top'>
        <div class="row">
          <div id='header-text' class="col-12 text-center text-white">
            Explore the Events of 9/11
          </div>
        </div>
      </header>

      <div id="fadeOutZone">

        <div id="top-panel">
          <img id="heroImage-prologue" class="hero-image" src="media/1_Looming_Crisis.jpeg" width="100%"></img>
          <img id="heroImage-attack" class="hero-image" src="media/2_Attack.jpeg" width="100%"></img>
          <img id="heroImage-response" class="hero-image" src="media/3_Rescue.jpeg" width="100%"></img>
          <img id="heroImage-military" class="hero-image" src="media/4_Military_Response.jpeg" width="100%"></img>
          <img id="heroImage-legacy" class="hero-image" src="media/5_Legacy.jpeg" width="100%"></img>


          <div id="content-pane" class="row mx-0 px-0">
            <div id="description-text" class="text-white col-12 mt-3 px-3">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </div>
            <div class='col-12 text-center mt-1'>
              <button id='learn-more' class='btn btn-lg btn-secondary' onclick="gotoPage()">Learn More</button>
            </div>
          </div>



        </div>

        <div id='icon-row' class='row mt-5 mx-0 align-items-end'>
          <div class='col px-0'>
            <div id="icon-prologue" class='icon mx-auto' onclick="selectTopic('icon-prologue')">
              <img src='thumbnails/1_Looming_Crisis.jpeg' width="100%"></img>
            </div>
          </div>
          <div class='col px-0'>
            <div id="icon-attack" class="icon mx-auto" onclick="selectTopic('icon-attack')">
              <img src='thumbnails/2_Attack.jpeg' width="100%"></img>
            </div>
          </div>
          <div class='col px-0'>
            <center>
              <div id="icon-response" class="icon mx-auto" onclick="selectTopic('icon-response')">
                <img src='thumbnails/3_Rescue.jpeg' width="100%"></img>
              </div>
            </center>
          </div>
          <div class='col px-0'>
            <div id="icon-military" class="icon mx-auto" onclick="selectTopic('icon-military')">
              <img src='thumbnails/4_Military_Response.jpeg' width="100%"></img>
            </div>
          </div>
          <div class='col px-0'>
            <div id="icon-legacy" class="icon mx-auto" onclick="selectTopic('icon-legacy')">
              <img src='thumbnails/5_Legacy.jpeg' width="100%"></img>
            </div>
          </div>
        </div>
      </div>
      <footer id='toolbar' class='bg-secondary fixed-bottom'>
        <div class='row h-100 gx-1'>
          <div class='col-2'>
            <button id="langToggleButton" class='btn btn-primary w-100 h-100' onclick="toggleLang();">Espanol</button>
          </div>
          <div class='col-1'>
            <button class='btn btn-primary w-100 h-100' onclick="fontSizeDecrease()"><font size="50px">A</font></button>
          </div>
          <div class='col-1'>
            <button class='btn btn-primary w-100 h-100' onclick="fontSizeIncrease()"><font size="80px">A</font></button>
          </div>
        </div>
      </footer>
    </main>
  </body>

  <script type="text/javascript" src="js/jquery-3.6.0.min.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>

  <script type="text/javascript" src="content.js"></script>

  <script>

    function attractor() {

      // firstStarted == true when the page is first loaded; we start the
      // attractor right away
      if (firstStarted) {
        currentIdleTime = idleTimeLimit + 1;
        firstStarted = false;
      }
      if (currentIdleTime > idleTimeLimit) {
        fontSizeReset();
        setLang("en");
        currentPosition += 1;
        if (currentPosition > 4) {
          currentPosition = 0;
        }
        selectTopic(attractorSequence[currentPosition]);
      } else {
        currentIdleTime += attractorIntervalTime;
      }
    }

    function fontSizeDecrease() {

      var newSize = parseInt($("#description-text").css("fontSize").slice(0,-2)) - 3;
      if (newSize < 40) {
        newSize = 40;
      } else {
        // Also change the size of the content pane
        newHeight = parseInt($("#content-pane").css("height").slice(0,-2)) - 30;
        newTop = parseInt($("#content-pane").css("top").slice(0,-2)) + 30;
        newLeft = parseInt($("#content-pane").css("left").slice(0,-2)) + 5;
        newWidth = parseInt($("#content-pane").css("width").slice(0,-2)) - 10;
        newDescHeight = parseInt($("#description-text").css("height").slice(0,-2)) - 25;
        $("#content-pane").animate({"height": newHeight, "left": newLeft, "top": newTop, "width": newWidth, queue: false}, 100);
        $("#description-text").animate({"height": newDescHeight, queue: false}, 100);
      }
      fontSizeSet(newSize);
    }

    function fontSizeIncrease() {

      var newSize = parseInt($("#description-text").css("fontSize").slice(0,-2)) + 3;
      if (newSize > 70) {
        newSize = 70;
      } else {
        // Also change the size of the content pane
        newHeight = parseInt($("#content-pane").css("height").slice(0,-2)) + 30;
        newWidth = parseInt($("#content-pane").css("width").slice(0,-2)) + 10;
        newTop = parseInt($("#content-pane").css("top").slice(0,-2)) - 30;
        newLeft = parseInt($("#content-pane").css("left").slice(0,-2)) - 5;
        newDescHeight = parseInt($("#description-text").css("height").slice(0,-2)) + 25;
        $("#content-pane").animate({"height": newHeight, "left": newLeft, "top": newTop, "width": newWidth, queue: false}, 100);
        $("#description-text").animate({"height": newDescHeight, queue: false}, 100);
      }
      fontSizeSet(newSize);


    }

    function fontSizeReset() {

      fontSizeSet(40);
      $("#description-text").animate({scrollTop: 0, queue: false});
      $("#content-pane").animate({"height": contentPaneHeightDefault,
                                  "left": contentPaneLeftDefault,
                                  "top": contentPaneTopDefault,
                                  "width": contentPaneWidthDefault,
                                  queue: false}
                                  , 100);
      $("#description-text").animate({"height": descriptionHeightDefault,
                                     queue: false},
                                     100)
    }

    function fontSizeSet(size, animate=true) {

      var duration;
      if (animate) {
        duration = 100;
      } else {
        duration = 0;
      }

      $("#learn-more").animate({fontSize: size, queue: false}, duration);
      $("#description-text").animate({fontSize: size, queue: false}, duration);

    }

    function gotoPage() {

      $("#fadeOutZone").fadeOut(400, function(){window.location.href = '2_attack/2_attack.html'});
    }

    function localize() {

      // Make sure every content field has content for the appropriate language

      $("#header-text").html(title_text[currentLang]);
      $("#learn-more").html(learn_more_button_text[currentLang]);
      $("#langToggleButton").html(lang_toggle_text[currentLang]);
      setDescription(currentTopic);
    }

    function selectTopic(id) {

      // Called when an icon is clicked

      var topic = id.split("-")[1]
      $(".icon").animate({width: "17vw"}, {duration:150, queue:false})
      $("#"+id).animate({width: "23vw"}, {duration:150, queue:false})

      $('.hero-image').not("#heroImage-"+topic).animate({opacity:0, queue:false});
      $("#heroImage-"+topic).animate({opacity: 1, queue:false})
      setDescription(topic);
    }

    function setDescription(topic) {

        // Change the text in the description box
        currentTopic = topic;

        var textToSet = "";
        switch (topic) {
          case "prologue":
            textToSet = prologue_description[currentLang];
            currentPosition = 0;
            break;
          case "attack":
            textToSet = attack_description[currentLang];
            currentPosition = 1;
            break;
          case "response":
            textToSet = response_description[currentLang];
              currentPosition = 2;
            break;
          case "military":
            textToSet = military_description[currentLang];
            currentPosition = 3;
            currentTopic = topic;
            break;
          case "legacy":
            textToSet = legacy_description[currentLang];
            currentPosition = 4;
            currentTopic = topic;
            break;
          default:
            console.log("Error, unknown topic:", topic)
            return;
        }
      $("#description-text").html(textToSet);
    }

    function setLang(lang) {

      currentLang = lang;
      localize();
    }

    function toggleLang() {

      // Switch between English and Spanish, updating visible content.
      if (currentLang == "en") {
        currentLang = "es";
      } else {
        currentLang = "en";
      }
      localize();
    }

    // Attractor variables
    var attractorSequence = ["icon-prologue", "icon-attack", "icon-response", "icon-military", "icon-legacy"];
    var currentPosition = 0; // Index of where we are in the sequence
    var attractorIntervalReference = null; // Will hold a reference to the setInterval instance
    var attractorIntervalTime = 3; // Seconds between switches
    var idleTimeLimit = 30; // Seconds from last interaction until we show the attractor
    var currentIdleTime = 0;
    var firstStarted = false;

    // Layout defautls. Set to null now, will be filled when document loads
    contentPaneHeightDefault = null;
    contentPaneWidthDefault = null;
    contentPaneLeftDefault = null;
    contentPaneTopDefault = null;
    descriptionHeightDefault = null;

    var currentLang = "en";
    var currentTopic = "prologue";

    $(document).ready(function(){
      selectTopic("icon-prologue");
      $("#fadeOutZone").animate({opacity: 1, queue: false}, 400)

      contentPaneHeightDefault = parseInt($("#content-pane").css("height").slice(0,-2));
      contentPaneWidthDefault = parseInt($("#content-pane").css("width").slice(0,-2));
      contentPaneTopDefault = parseInt($("#content-pane").css("top").slice(0,-2));
      contentPaneLeftDefault = parseInt($("#content-pane").css("left").slice(0,-2));
      descriptionHeightDefault = parseInt($("#content-pane").css("height").slice(0,-2));
    });
    $(document).click(function(event){
      // Reset the attractor count if a click occurs
      currentIdleTime = 0;
    });
    document.addEventListener('touchstart', function(event) {
      // Reset the attractor count if a click occurs
      currentIdleTime = 0;
    });

    attractorIntervalReference = setInterval(attractor, attractorIntervalTime*1000);

  </script>

</html>
